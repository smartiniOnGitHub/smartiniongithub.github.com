<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl">
  <title data-ice="title">Home | cloudevent</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="JavaScript/Node.js implementation of the CloudEvents standard format"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="cloudevent"><meta property="twitter:description" content="JavaScript/Node.js implementation of the CloudEvents standard format"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/smartiniOnGitHub/cloudevent.js"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/cloudevent.js~CloudEvent.html">CloudEvent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/jsonbatch.js~JSONBatch.html">JSONBatch</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/transformer.js~Transformer.html">Transformer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/validator.js~Validator.html">Validator</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><div data-ice="index" class="github-markdown"><h1 id="cloudevent---cloudevent-js">cloudevent / cloudevent.js</h1><p>  <a href="https://npmjs.org/package/cloudevent/"><img src="https://img.shields.io/npm/v/cloudevent.svg?style=flat" alt="NPM Version"></a>
  <a href="https://npmjs.org/package/cloudevent/"><img src="https://img.shields.io/npm/dm/cloudevent.svg?style=flat" alt="NPM Downloads"></a>
  <a href="http://standardjs.com/"><img src="https://img.shields.io/badge/code%20style-standard-brightgreen.svg?style=flat" alt="Code Style"></a>
  <a href="https://coveralls.io/github/smartiniOnGitHub/cloudevent.js/?branch=master"><img src="https://coveralls.io/repos/github/smartiniOnGitHub/cloudevent.js/badge.svg?branch=master" alt="Coverage Status"></a>
  <a href="https://david-dm.org/smartiniOnGitHub/cloudevent.js"><img src="https://david-dm.org/smartiniOnGitHub/cloudevent.js/status.svg" alt="dependencies Status"></a>
  <a href="https://david-dm.org/smartiniOnGitHub/cloudevent.js?type=dev"><img src="https://david-dm.org/smartiniOnGitHub/cloudevent.js/dev-status.svg" alt="devDependencies Status"></a>
  <a href="https://snyk.io//test/github/smartiniOnGitHub/cloudevent.js?targetFile=package.json"><img src="https://snyk.io//test/github/smartiniOnGitHub/cloudevent.js/badge.svg?targetFile=package.json" alt="Known Vulnerabilities"></a>
  <a href="http://opensource.org/licenses/APACHE-2.0"><img src="https://img.shields.io/npm/l/cloudevent.svg" alt="license - APACHE-2.0"></a></p>
<p>JavaScript/Node.js implementation of <a href="http://cloudevents.io/">CloudEvents</a></p>
<p>Current release implements the v0.3 of the CloudEvents Spec.</p>
<p>The purpose of this library is to create instances of CloudEvents in a simple way 
(with some useful defaults), or in a full way (all attributes).
Optional, it&apos;s possible to validate created instances to be sure they are compliant with the standard.</p>
<p>Then, created instances can be serialized, for example to be sent (or saved/stored) somewhere.</p>
<p>Note that many features are exposed directly by the CloudEvent class with standard class instance 
methods, and even as class static methods (that operates on a given CloudEvent).
Anyway, to be more future-proof the library now exports a main object, with all features inside 
(the class for CloudEvent, its Validator class as CloudEventValidator, etc); 
using destructuring assignment (as seen in code samples) usage will be easier.</p>
<h2 id="usage">Usage</h2><p>Get a reference to the library:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">// Node.js example

// reference the library, not needed if using destructuring assignment, see below
const CloudEventExports = require(&apos;cloudevent&apos;)

// minimal, most common usage
// const { CloudEvent } = require(&apos;cloudevent&apos;)
// other, get more objects exposed by the library
const { CloudEvent, CloudEventValidator: V, CloudEventTransformer: T } = require(&apos;cloudevent&apos;)
assert(CloudEvent !== null &amp;&amp; V !== null &amp;&amp; T !== null)</code>
</code></pre>
<p>create some sample CloudEvent instances:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">// create some sample instances but without mandatory fields (for validation) ...
const ceEmpty = new CloudEvent() // create an empty CloudEvent instance (not valid for the validator, even in default case, when strict mode flag is disabled)
const ceMinimalMandatoryUndefinedNoStrict = new CloudEvent(undefined, undefined, undefined, undefined, { strict: false }) // expected success
const ceMinimalMandatoryUndefinedStrict = new CloudEvent(undefined, undefined, undefined, undefined, { strict: true }) // expected failure, so ceMinimalMandatoryUndefinedStrict will not be defined

// define some common attributes
const ceCommonOptions = {
  time: new Date(),
  datacontenttype: &apos;application/json&apos;,
  schemaurl: &apos;http://my-schema.localhost.localdomain/v1/&apos;,
  subject: &apos;subject&apos;,
  strict: false // same as default
}
const ceCommonOptionsStrict = { ...ceCommonOptions, strict: true }
const ceCommonExtensions = { exampleExtension: &apos;value&apos; }
const ceNamespace = &apos;com.github.smartiniOnGitHub.cloudeventjs.testevent-v1.0.0&apos;
const ceServerUrl = &apos;/test&apos;
const ceCommonData = { hello: &apos;world&apos;, year: 2019 }

// create some sample minimal instances, good even for validation ...
const ceMinimal = new CloudEvent(&apos;1&apos;, // id
  ceNamespace, // type
  &apos;/&apos;, // source
  {} // data (empty) // optional, but useful the same in this sample usage
)

// create some instances with an undefined mandatory argument (handled by defaults), but with strict flag disabled: expected success ...
// note that null values are not handled by default values, only undefined values ...
const ceFull = new CloudEvent(&apos;1/full&apos;,
  ceNamespace,
  ceServerUrl,
  ceCommonData, // data
  ceCommonOptions,
  ceCommonExtensions
)
const ceFullStrict = new CloudEvent(&apos;2/full-strict&apos;,
  ceNamespace,
  ceServerUrl,
  ceCommonData, // data
  ceCommonOptionsStrict, // use common options, but set strict mode to true
  ceCommonExtensions
)
assert(ceFullStrict.isStrict)
assert(!ceFull.isStrict) // ensure common options object has not been changed when reusing some of its values for the second instance
assert(!CloudEvent.isStrictEvent(ceFull)) // the same, but using static method
// create an instance that wrap an Error
const error = new Error(&apos;sample error&apos;)
error.code = 1000 // add a sample error code, as number
const errorToData = T.errorToData(error, {
  includeStackTrace: true,
  // addStatus: false,
  addTimestamp: true
})
const ceErrorStrict = new CloudEvent(&apos;2/error-strict&apos;,
  ceNamespace,
  ceServerUrl,
  errorToData, // data
  ceCommonOptionsStrict, // use common options, but set strict mode to true
  ceCommonExtensions
)
assert(ceErrorStrict !== null)
assert(ceErrorStrict.isStrict)
assert(!ceErrorStrict.isStrict) // ensure common options object has not been changed when reusing some of its values for the second instance
assert(!CloudEvent.isStrictEvent(ceErrorStrict)) // the same, but using static method
// create an instance with a different content type
const ceFullStrictOtherContentType = new CloudEvent(&apos;3/full-strict-other-content-type&apos;,
  ceNamespace,
  ceServerUrl,
  ceCommonData, // data
  { ...ceCommonOptionsStrict, datacontenttype: &apos;application/xml&apos; }, // use common strict options, but set strict mode to true
  ceCommonExtensions
)
assert(ceFullStrictOtherContentType !== null)
assert(ceFullStrictOtherContentType.isStrict)</code>
</code></pre>
<p>optional, do some validations/checks on created instances.
As sample, use class static methods like &apos;isValidEvent&apos; and &apos;ValidateEvent&apos;, 
or instance methods like &apos;isValid&apos;, &apos;validate&apos;, etc ...</p>
<pre><code class="lang-js"><code class="source-code prettyprint">assert(!ceEmpty.isValid())
assert(!ceMinimalMandatoryUndefinedNoStrict.isValid())
assert(ceMinimal.isValid())
assert(ceFull.isValid())
assert(ceFullStrict.isValid())
assert(ceErrorStrict.isValid())
assert(ceFullStrictOtherContentType.isValid())
// etc ...

console.log(`Validation on ceEmpty: isValid: ${ceEmpty.isValid()}`)

console.log(`Validation output for ceEmpty, default strict mode is: size: ${CloudEvent.validateEvent(ceEmpty).length}, details:\n` + CloudEvent.validateEvent(ceEmpty))
console.log(`Validation output for ceEmpty, force strict mode to true is size: ${CloudEvent.validateEvent(ceEmpty, { strict: true }).length}, details:\n` + CloudEvent.validateEvent(ceEmpty, { strict: true }))</code>
</code></pre>
<p>serialization examples:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">// default contenttype
const ceFullSerializedStatic = CloudEvent.serializeEvent(ceFull)
const ceFullSerialized = ceFull.serialize()
console.log(&apos;Serialization output for ceFull, details:\n&apos; + ceFullSerialized)
const ceFullStrictSerialized = ceFullStrict.serialize()
console.log(&apos;Serialization output for ceFullStrict, details:\n&apos; + ceFullStrictSerialized)
// non default contenttype
const ceFullStrictOtherContentTypeSerializedStatic = CloudEvent.serializeEvent(ceFullStrictOtherContentType, {
  // encoder: (data) =&gt; &apos;&lt;data &quot;encoder&quot;=&quot;sample&quot; /&gt;&apos;,
  encodedData: &apos;&lt;data &quot;hello&quot;=&quot;world&quot; &quot;year&quot;=&quot;2019&quot; /&gt;&apos;,
  onlyValid: true
})
const ceFullStrictOtherContentTypeSerialized = ceFullStrictOtherContentType.serialize({
  // encoder: (data) =&gt; &apos;&lt;data &quot;encoder&quot;=&quot;sample&quot; /&gt;&apos;,
  encodedData: &apos;&lt;data &quot;hello&quot;=&quot;world&quot; &quot;year&quot;=&quot;2019&quot; /&gt;&apos;,
  onlyValid: true
})
console.log(&apos;Serialization output for ceFullStrictOtherContentType, details:\n&apos; + ceFullStrictOtherContentTypeSerialized)

// then use (send/store/etc) serialized instances ...
</code>
</code></pre>
<p>deserialization (parse) examples:</p>
<pre><code class="lang-js"><code class="source-code prettyprint">// deserialization examples
// default contenttype
console.log(&apos;\nSome deserialization/parse examples:&apos;)
const ceFullDeserialized = CloudEvent.deserializeEvent(ceFullSerialized)
assert(ceFullDeserialized !== null)
assert(ceFullDeserialized.isValid())
assert(!ceFullDeserialized.isStrict)
assert(CloudEvent.isCloudEvent(ceFullDeserialized))
console.log(`cloudEvent dump: ${T.dumpObject(ceFullDeserialized, &apos;ceFullDeserialized&apos;)}`)
const ceFullStrictDeserializedOnlyValid = CloudEvent.deserializeEvent(ceFullStrictSerialized, { onlyValid: true })
assert(ceFullStrictDeserializedOnlyValid !== null)
console.log(`cloudEvent dump: ${T.dumpObject(ceFullStrictDeserializedOnlyValid, &apos;ceFullStrictDeserializedOnlyValid&apos;)}`)
// non default contenttype
const ceFullStrictOtherContentTypeDeserialized = CloudEvent.deserializeEvent(ceFullStrictOtherContentTypeSerialized, {
  // decoder: (data) =&gt; { decoder: &apos;Sample&apos; },
  decodedData: { hello: &apos;world&apos;, year: 2019 },
  onlyValid: true
})
assert(ceFullStrictOtherContentTypeDeserialized !== null)
assert(ceFullStrictOtherContentTypeDeserialized.isValid())
assert(ceFullStrictOtherContentTypeDeserialized.isStrict)
assert(CloudEvent.isCloudEvent(ceFullStrictOtherContentTypeDeserialized))
console.log(`cloudEvent dump: ${T.dumpObject(ceFullStrictOtherContentTypeDeserialized, &apos;ceFullStrictOtherContentTypeDeserialized&apos;)}`)

// then use (validate/send/store/etc) deserialized instances ...
</code>
</code></pre>
<p>Look into the <a href="./example/">example</a> folder for more sample scripts that uses the library 
(inline but it&apos;s the same using it from npm registry); 
you can find even examples for using JSONBatch objects (array of CloudEvent instances).</p>
<h2 id="requirements">Requirements</h2><p>Node.js 8.16.x or later.</p>
<h2 id="note">Note</h2><p>Note that in this implementation there is even the ability to validate CloudEvent instances 
in a stricter way, by setting to true the attribute &apos;strict&apos; in options in constructor options; 
or specify it during validation.
That attribute when set will be put in the &apos;extensions&apos; standard attribute of a CloudEvent.</p>
<p>You can find Code Documentation for the API of the library <a href="https://smartiniongithub.github.io/cloudevent.js/">here</a>.</p>
<p>See the CloudEvents Specification <a href="https://github.com/cloudevents/spec">here</a>.</p>
<p>In the past the name for this package was &apos;cloudevent.js&apos;, but it has been deprecated now 
and changed to the simpler &apos;cloudevent&apos;, so it will be easier to get it at npm.</p>
<p>Since v0.2 of the spec, there is no more a standard attribute to specify the version 
of any specific event type, so the best if to follow their recommendations, 
and for example add a version in the &apos;type&apos; attribute 
(for example &apos;-v1.0.0&apos; at the end of its base value, or at the end of its full value) ,
or into the &apos;schemaurl&apos; attribute but only its major version 
(like &apos;-v1&apos; or &apos;/v1/&apos; at the end).
Since v0.3 of the spec, there is no more a standard attribute for extensions, 
so they are merged into usual properties (but must not use names 
of standard properties); a best practice is to use reverse-DNS name 
but without dots, so like &apos;com_github_smartiniOnGitHub_cloudevent&apos;.</p>
<h2 id="contributing">Contributing</h2><ol>
<li>Fork it ( <a href="https://github.com/smartiniOnGitHub/cloudevent.js/fork">https://github.com/smartiniOnGitHub/cloudevent.js/fork</a> )</li>
<li>Create your feature branch (git checkout -b my-new-feature)</li>
<li>Commit your changes (git commit -am &apos;Add some feature&apos;)</li>
<li>Push to the branch (git push origin my-new-feature)</li>
<li>Create a new Pull Request</li>
</ol>
<h2 id="license">License</h2><p>Licensed under <a href="./LICENSE">Apache-2.0</a>.</p>
<hr>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
